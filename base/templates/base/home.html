{% extends 'base/base.html' %}
{% load static %}

{% block title %}DMTOOLS{% endblock %}

{% block custom_scripts %}
  <script src="{% static 'js/homepagescripts.js' %}"></script>
{% endblock %}

{% block content %}
  <span style="display: none;" id="context"></span>
  <div class="row">
    <div class="col-sm pb-2">
      <input type="text"
             class="form-control"
             placeholder="Apply effect"
             aria-label="Effect to apply"
             id="effect-to-apply"
      >
    </div>
    <div class="col-sm pb-2">
      <div class="btn-group btn-block apply-context-hide remove-context-hide" role="group"
           aria-label="apply effect buttons">
        <button class="btn btn-outline-success enter-buff-apply-context" type="button" style="width: 33.3%;">
          Buff
        </button>
        <button class="btn btn-outline-danger enter-debuff-apply-context" type="button" style="width: 33.3%;">
          Debuff
        </button>
        <button class="btn btn-outline-secondary enter-other-apply-context" type="button" style="width: 33.3%;">
          Other
        </button>
      </div>

      <form action="{% url 'ajax-update-effect-list' %}" method="post" id="effect-add-form">
        {% csrf_token %}
        <div class="btn-group btn-block apply-context-show" role="group" aria-label="apply effect cancel and submit"
             style="display: none;">
          <button class="btn btn-outline-primary exit-apply-context w-50"
                  type="button"
                  id="cancel-apply-button"
          >
            Cancel
          </button>
          <button class="btn btn-primary w-50"
                  type="submit"
                  id="apply-button"
                  disabled
          >
            Apply
          </button>
        </div>
        {% for combatant in combatant_list %}
          <input
              type="hidden"
              name="effect_{{ combatant.id }}_buff"
              id="{{ combatant.id }}-buff"
              class="effect-input"
          >
          <input
              type="hidden"
              name="effect_{{ combatant.id }}_debuff"
              id="{{ combatant.id }}-debuff"
              class="effect-input"
          >
          <input
              type="hidden"
              name="effect_{{ combatant.id }}_other"
              id="{{ combatant.id }}-other"
              class="effect-input"
          >
        {% endfor %}
      </form>
    </div>

    <div class="col-sm pb-2 d-flex justify-content-between">
      {% if user.is_authenticated %}
        <a href="{% url 'combatant-add' %}"
           class="btn btn-outline-success combatant-context-hide remove-context-hide"
           id="add-combatant"
           style="width: 48%;"
        >
          Add a combatant
        </a>
        <button class="btn btn-success remove-context-show"
                id="cancel-remove"
                style="width: 48%; display: none;">
          Cancel
        </button>
        <a href="#"
           class="btn btn-outline-danger combatant-context-hide"
           id="remove-combatants"
           style="width: 48%;"
        >
          Remove combatants
        </a>
      {% endif %}
    </div>
  </div>

  <div class="card-deck" id="combatant-card-deck">
    {% include 'base/combatant_card_deck.html' %}
  </div>

  <div class="btn-toolbar combatant-context-show" role="toolbar" aria-label="Toolbar with combatant buttons"
       style="display: none;">
    {% for combatant in combatant_list %}
      {% include 'base/combatant_button.html' %}
    {% endfor %}
  </div>

{% endblock %}
